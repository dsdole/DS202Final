---
title: "R Notebook"
output: html_document
author: "Dhruv Dole, Ahmed Gharib"
---
```{r}
library(tidyverse)
raw_data <- read.csv("https://raw.githubusercontent.com/dsdole/DS202Final/main/data/Expanded_data_with_more_features.csv")
```
```{r}
raw_data
raw_data$Gender <- as.factor(raw_data$Gender)
raw_data$EthnicGroup <- as.factor(raw_data$EthnicGroup)
raw_data$ParentEduc <- as.factor(raw_data$EthnicGroup)
raw_data$LunchType <- as.factor(raw_data$LunchType)
raw_data$TestPrep <- as.factor(raw_data$TestPrep)
raw_data$ParentMaritalStatus <- as.factor(raw_data$ParentMaritalStatus)
#raw_data$isFirstChild <- as.factor(raw_data$isFirstChild)
raw_data$TransportMeans <- as.factor(raw_data$TransportMeans)
unique(raw_data$WklyStudyHours)
#raw_data$WklyStudyHours <- as.factor(raw_data$WklyStudyHours,ordered=TRUE,levels=c("< 5", "5 - 10", "> 10"))
```
# Erasing "X" from the dataset:
```{r}
library(dplyr)

raw_data <- select(raw_data, -X)
head(raw_data)
```
# Factoring WklyStudyHours
```{r}
raw_data$WklyStudyHours <- factor(raw_data$WklyStudyHours, ordered = TRUE,
                                  levels = c("< 5", "5 - 10", "> 10"))
```

# Filling empty space
```{r}
cleanraw_data <- raw_data %>%
  mutate_all(~replace(., .=="", NA))
```

```{r}
cleanraw_data %>%
  summarise_all(~mean(is.na(.)) * 100)
```


# Visual of clean data
```{r}
head(cleanraw_data)
```

# Correlation plots (Ahmed Gharib)
## 1 - Average score affected by students according to their Practicing sports status:
```{r}
library(ggplot2)

AvgScore <- rowMeans(cleanraw_data[, c("MathScore", "ReadingScore", "WritingScore")], na.rm = TRUE)


ggplot(cleanraw_data, aes(x = PracticeSport, y = AvgScore, fill = Gender)) +
  stat_summary(fun = mean, geom = "bar", position = "dodge", alpha = 0.8) +
  scale_fill_manual(values = c("orange", "purple")) +
  labs(x = "Practicing sports status", y = "Average Score", fill = "Gender") +
  theme_bw()

```
As we can see above the Average overall scores affected by students who practice sports compared to those who do not, is not a huge difference. Very similar overall.

## 2 - Weekly study hours affection of Average scores

```{r}
# Load required packages
library(ggplot2)

# Compute average score
AvgScore <- rowMeans(cleanraw_data[, c("MathScore", "ReadingScore", "WritingScore")], na.rm = TRUE)

ggplot(cleanraw_data, aes(x = AvgScore, fill = factor(WklyStudyHours))) +
  geom_histogram(binwidth = 2, position = "dodge") +
  scale_fill_manual(values = c("black", "blue", "red")) +
  labs(title = "Distribution of Average Scores by Weekly Study Hours",
       x = "Average Score",
       y = "Student Count",
       fill = "Weekly Study Hours") +
  theme_minimal()

```


